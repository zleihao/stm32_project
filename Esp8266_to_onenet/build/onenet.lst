ARM GAS  /tmp/ccSHUK9b.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 1
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"onenet.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.rodata.OneNet_DevLink.str1.4,"aMS",%progbits,1
  16              		.align	2
  17              	.LC0:
  18 0000 31323334 		.ascii	"12345\000"
  18      3500
  19 0006 0000     		.align	2
  20              	.LC1:
  21 0008 34373139 		.ascii	"471989\000"
  21      383900
  22 000f 00       		.align	2
  23              	.LC2:
  24 0010 4F6E654E 		.ascii	"OneNet_DevLink\015\012PROID: %s,\011AUIF: %s,\011DE"
  24      65745F44 
  24      65764C69 
  24      6E6B0D0A 
  24      50524F49 
  25 0037 5649443A 		.ascii	"VID:%s\015\012\000"
  25      25730D0A 
  25      00
  26              		.align	2
  27              	.LC3:
  28 0040 38353735 		.ascii	"857569357\000"
  28      36393335 
  28      3700
  29 004a 0000     		.align	2
  30              	.LC4:
  31 004c 54697073 		.ascii	"Tips:\011\350\277\236\346\216\245\346\210\220\345\212"
  31      3A09E8BF 
  31      9EE68EA5 
  31      E68890E5 
  31      8A
  32 005d 9F0D0A00 		.ascii	"\237\015\012\000"
  33 0061 000000   		.align	2
  34              	.LC5:
  35 0064 5741524E 		.ascii	"WARN:\011\350\277\236\346\216\245\345\244\261\350\264"
  35      3A09E8BF 
  35      9EE68EA5 
  35      E5A4B1E8 
  35      B4
  36 0075 A5EFBC9A 		.ascii	"\245\357\274\232\345\215\217\350\256\256\351\224\231"
  36      E58D8FE8 
  36      AEAEE994 
  36      99
ARM GAS  /tmp/ccSHUK9b.s 			page 2


  37 0082 E8AFAF0D 		.ascii	"\350\257\257\015\012\000"
  37      0A00
  38              		.align	2
  39              	.LC6:
  40 0088 5741524E 		.ascii	"WARN:\011\350\277\236\346\216\245\345\244\261\350\264"
  40      3A09E8BF 
  40      9EE68EA5 
  40      E5A4B1E8 
  40      B4
  41 0099 A5EFBC9A 		.ascii	"\245\357\274\232\351\235\236\346\263\225\347\232\204"
  41      E99D9EE6 
  41      B395E79A 
  41      84
  42 00a6 636C6965 		.ascii	"clientid\015\012\000"
  42      6E746964 
  42      0D0A00
  43 00b1 000000   		.align	2
  44              	.LC7:
  45 00b4 5741524E 		.ascii	"WARN:\011\350\277\236\346\216\245\345\244\261\350\264"
  45      3A09E8BF 
  45      9EE68EA5 
  45      E5A4B1E8 
  45      B4
  46 00c5 A5EFBC9A 		.ascii	"\245\357\274\232\346\234\215\345\212\241\345\231\250"
  46      E69C8DE5 
  46      8AA1E599 
  46      A8
  47 00d2 E5A4B1E8 		.ascii	"\345\244\261\350\264\245\015\012\000"
  47      B4A50D0A 
  47      00
  48 00db 00       		.align	2
  49              	.LC8:
  50 00dc 5741524E 		.ascii	"WARN:\011\350\277\236\346\216\245\345\244\261\350\264"
  50      3A09E8BF 
  50      9EE68EA5 
  50      E5A4B1E8 
  50      B4
  51 00ed A5EFBC9A 		.ascii	"\245\357\274\232\347\224\250\346\210\267\345\220\215"
  51      E794A8E6 
  51      88B7E590 
  51      8D
  52 00fa E68896E5 		.ascii	"\346\210\226\345\257\206\347\240\201\351\224\231\350"
  52      AF86E7A0 
  52      81E99499 
  52      E8
  53 0107 AFAF0D0A 		.ascii	"\257\257\015\012\000"
  53      00
  54              		.align	2
  55              	.LC9:
  56 010c 5741524E 		.ascii	"WARN:\011\350\277\236\346\216\245\345\244\261\350\264"
  56      3A09E8BF 
  56      9EE68EA5 
  56      E5A4B1E8 
  56      B4
  57 011d A5EFBC9A 		.ascii	"\245\357\274\232\351\235\236\346\263\225\351\223\276"
  57      E99D9EE6 
  57      B395E993 
ARM GAS  /tmp/ccSHUK9b.s 			page 3


  57      BE
  58 012a E68EA528 		.ascii	"\346\216\245(\346\257\224\345\246\202token\351\235\236"
  58      E6AF94E5 
  58      A682746F 
  58      6B656EE9 
  58      9D9E
  59 013c E6B39529 		.ascii	"\346\263\225)\015\012\000"
  59      0D0A00
  60 0143 00       		.align	2
  61              	.LC10:
  62 0144 4552523A 		.ascii	"ERR:\011\350\277\236\346\216\245\345\244\261\350\264"
  62      09E8BF9E 
  62      E68EA5E5 
  62      A4B1E8B4 
  63 0154 A5EFBC9A 		.ascii	"\245\357\274\232\346\234\252\347\237\245\351\224\231"
  63      E69CAAE7 
  63      9FA5E994 
  63      99
  64 0161 E8AFAF0D 		.ascii	"\350\257\257\015\012\000"
  64      0A00
  65 0167 00       		.align	2
  66              	.LC11:
  67 0168 5741524E 		.ascii	"WARN:\011MQTT_PacketConnect Failed\015\012\000"
  67      3A094D51 
  67      54545F50 
  67      61636B65 
  67      74436F6E 
  68              		.section	.text.OneNet_DevLink,"ax",%progbits
  69              		.align	1
  70              		.global	OneNet_DevLink
  71              		.arch armv7-m
  72              		.syntax unified
  73              		.thumb
  74              		.thumb_func
  75              		.fpu softvfp
  77              	OneNet_DevLink:
  78              	.LFB32:
  79              		.file 1 "./Hardware/onenet/onenet.c"
   1:./Hardware/onenet/onenet.c **** #include "onenet.h"
   2:./Hardware/onenet/onenet.c **** 
   3:./Hardware/onenet/onenet.c **** 
   4:./Hardware/onenet/onenet.c **** char *req_payload = NULL;   //onenet平台下发的数据
   5:./Hardware/onenet/onenet.c **** 
   6:./Hardware/onenet/onenet.c **** extern unsigned char esp8266_buf[128];
   7:./Hardware/onenet/onenet.c **** 
   8:./Hardware/onenet/onenet.c **** 
   9:./Hardware/onenet/onenet.c **** //==========================================================
  10:./Hardware/onenet/onenet.c **** //	函数名称：	OneNet_DevLink
  11:./Hardware/onenet/onenet.c **** //
  12:./Hardware/onenet/onenet.c **** //	函数功能：	与onenet创建连接
  13:./Hardware/onenet/onenet.c **** //
  14:./Hardware/onenet/onenet.c **** //	入口参数：	无
  15:./Hardware/onenet/onenet.c **** //
  16:./Hardware/onenet/onenet.c **** //	返回参数：	1-成功	0-失败
  17:./Hardware/onenet/onenet.c **** //
  18:./Hardware/onenet/onenet.c **** //	说明：		与onenet平台建立连接
  19:./Hardware/onenet/onenet.c **** //==========================================================
ARM GAS  /tmp/ccSHUK9b.s 			page 4


  20:./Hardware/onenet/onenet.c **** _Bool OneNet_DevLink(void)
  21:./Hardware/onenet/onenet.c **** {
  80              		.loc 1 21 1 view -0
  81              		.cfi_startproc
  82              		@ args = 0, pretend = 0, frame = 16
  83              		@ frame_needed = 0, uses_anonymous_args = 0
  84 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
  85              	.LCFI0:
  86              		.cfi_def_cfa_offset 24
  87              		.cfi_offset 4, -24
  88              		.cfi_offset 5, -20
  89              		.cfi_offset 6, -16
  90              		.cfi_offset 7, -12
  91              		.cfi_offset 8, -8
  92              		.cfi_offset 14, -4
  93 0004 8AB0     		sub	sp, sp, #40
  94              	.LCFI1:
  95              		.cfi_def_cfa_offset 64
  22:./Hardware/onenet/onenet.c **** 	
  23:./Hardware/onenet/onenet.c **** 	MQTT_PACKET_STRUCTURE mqttPacket = {NULL, 0, 0, 0};					//协议包
  96              		.loc 1 23 2 view .LVU1
  97              		.loc 1 23 24 is_stmt 0 view .LVU2
  98 0006 06AD     		add	r5, sp, #24
  99 0008 0024     		movs	r4, #0
 100 000a 0694     		str	r4, [sp, #24]
 101 000c 0794     		str	r4, [sp, #28]
 102 000e 0894     		str	r4, [sp, #32]
 103 0010 0994     		str	r4, [sp, #36]
  24:./Hardware/onenet/onenet.c **** 
  25:./Hardware/onenet/onenet.c **** 	unsigned char *dataPtr;
 104              		.loc 1 25 2 is_stmt 1 view .LVU3
  26:./Hardware/onenet/onenet.c **** 	
  27:./Hardware/onenet/onenet.c **** 	_Bool status = 1;
 105              		.loc 1 27 2 view .LVU4
 106              	.LVL0:
  28:./Hardware/onenet/onenet.c **** 	
  29:./Hardware/onenet/onenet.c **** 	UsartPrintf(USART_DEBUG, "OneNet_DevLink\r\n"
 107              		.loc 1 29 2 view .LVU5
 108 0012 374F     		ldr	r7, .L17
 109 0014 374E     		ldr	r6, .L17+4
 110 0016 DFF8E080 		ldr	r8, .L17+8
 111 001a CDF80080 		str	r8, [sp]
 112 001e 3B46     		mov	r3, r7
 113 0020 3246     		mov	r2, r6
 114 0022 3649     		ldr	r1, .L17+12
 115 0024 3648     		ldr	r0, .L17+16
 116 0026 FFF7FEFF 		bl	UsartPrintf
 117              	.LVL1:
  30:./Hardware/onenet/onenet.c **** 							"PROID: %s,	AUIF: %s,	DEVID:%s\r\n"
  31:./Hardware/onenet/onenet.c ****                         , PROID, AUTH_INFO, DEVID);
  32:./Hardware/onenet/onenet.c **** 	
  33:./Hardware/onenet/onenet.c **** 	if(MQTT_PacketConnect(PROID, AUTH_INFO, DEVID, 256, 0, MQTT_QOS_LEVEL0, NULL, NULL, 0, &mqttPacket
 118              		.loc 1 33 2 view .LVU6
 119              		.loc 1 33 5 is_stmt 0 view .LVU7
 120 002a 0595     		str	r5, [sp, #20]
 121 002c 0494     		str	r4, [sp, #16]
 122 002e 0394     		str	r4, [sp, #12]
ARM GAS  /tmp/ccSHUK9b.s 			page 5


 123 0030 0294     		str	r4, [sp, #8]
 124 0032 0194     		str	r4, [sp, #4]
 125 0034 0094     		str	r4, [sp]
 126 0036 4FF48073 		mov	r3, #256
 127 003a 4246     		mov	r2, r8
 128 003c 3946     		mov	r1, r7
 129 003e 3046     		mov	r0, r6
 130 0040 FFF7FEFF 		bl	MQTT_PacketConnect
 131              	.LVL2:
 132              		.loc 1 33 4 view .LVU8
 133 0044 0028     		cmp	r0, #0
 134 0046 49D1     		bne	.L2
  34:./Hardware/onenet/onenet.c **** 	{
  35:./Hardware/onenet/onenet.c **** 		ESP8266_SendData(mqttPacket._data, mqttPacket._len);			//上传平台
 135              		.loc 1 35 3 is_stmt 1 view .LVU9
 136 0048 BDF81C10 		ldrh	r1, [sp, #28]
 137 004c 0698     		ldr	r0, [sp, #24]
 138 004e FFF7FEFF 		bl	ESP8266_SendData
 139              	.LVL3:
  36:./Hardware/onenet/onenet.c **** 		
  37:./Hardware/onenet/onenet.c **** 		dataPtr = ESP8266_GetIPD(250);									//等待平台响应
 140              		.loc 1 37 3 view .LVU10
 141              		.loc 1 37 13 is_stmt 0 view .LVU11
 142 0052 FA20     		movs	r0, #250
 143 0054 FFF7FEFF 		bl	ESP8266_GetIPD
 144              	.LVL4:
  38:./Hardware/onenet/onenet.c **** 		if(dataPtr != NULL)
 145              		.loc 1 38 3 is_stmt 1 view .LVU12
 146              		.loc 1 38 5 is_stmt 0 view .LVU13
 147 0058 0446     		mov	r4, r0
 148 005a 0028     		cmp	r0, #0
 149 005c 39D0     		beq	.L13
  39:./Hardware/onenet/onenet.c **** 		{
  40:./Hardware/onenet/onenet.c **** 			if(MQTT_UnPacketRecv(dataPtr) == MQTT_PKT_CONNACK)
 150              		.loc 1 40 4 is_stmt 1 view .LVU14
 151              		.loc 1 40 7 is_stmt 0 view .LVU15
 152 005e FFF7FEFF 		bl	MQTT_UnPacketRecv
 153              	.LVL5:
 154              		.loc 1 40 6 view .LVU16
 155 0062 0228     		cmp	r0, #2
 156 0064 01D0     		beq	.L16
  27:./Hardware/onenet/onenet.c **** 	
 157              		.loc 1 27 8 view .LVU17
 158 0066 0124     		movs	r4, #1
 159              	.LVL6:
  27:./Hardware/onenet/onenet.c **** 	
 160              		.loc 1 27 8 view .LVU18
 161 0068 34E0     		b	.L3
 162              	.LVL7:
 163              	.L16:
  41:./Hardware/onenet/onenet.c **** 			{
  42:./Hardware/onenet/onenet.c **** 				switch(MQTT_UnPacketConnectAck(dataPtr))
 164              		.loc 1 42 5 is_stmt 1 view .LVU19
 165              		.loc 1 42 12 is_stmt 0 view .LVU20
 166 006a 2046     		mov	r0, r4
 167 006c FFF7FEFF 		bl	MQTT_UnPacketConnectAck
 168              	.LVL8:
ARM GAS  /tmp/ccSHUK9b.s 			page 6


 169 0070 0528     		cmp	r0, #5
 170 0072 28D8     		bhi	.L4
 171 0074 DFE800F0 		tbb	[pc, r0]
 172              	.L6:
 173 0078 03       		.byte	(.L11-.L6)/2
 174 0079 09       		.byte	(.L10-.L6)/2
 175 007a 0F       		.byte	(.L9-.L6)/2
 176 007b 15       		.byte	(.L8-.L6)/2
 177 007c 1B       		.byte	(.L7-.L6)/2
 178 007d 21       		.byte	(.L5-.L6)/2
 179              		.p2align 1
 180              	.L11:
  43:./Hardware/onenet/onenet.c **** 				{
  44:./Hardware/onenet/onenet.c **** 					case 0:UsartPrintf(USART_DEBUG, "Tips:	连接成功\r\n");status = 0;break;
 181              		.loc 1 44 13 is_stmt 1 view .LVU21
 182 007e 2149     		ldr	r1, .L17+20
 183 0080 1F48     		ldr	r0, .L17+16
 184 0082 FFF7FEFF 		bl	UsartPrintf
 185              	.LVL9:
 186              		.loc 1 44 64 view .LVU22
 187              		.loc 1 44 75 view .LVU23
 188              		.loc 1 44 71 is_stmt 0 view .LVU24
 189 0086 0024     		movs	r4, #0
 190              	.LVL10:
 191              		.loc 1 44 6 view .LVU25
 192 0088 24E0     		b	.L3
 193              	.LVL11:
 194              	.L10:
  45:./Hardware/onenet/onenet.c **** 					
  46:./Hardware/onenet/onenet.c **** 					case 1:UsartPrintf(USART_DEBUG, "WARN:	连接失败：协议错误\r\n");break;
 195              		.loc 1 46 13 is_stmt 1 view .LVU26
 196 008a 1F49     		ldr	r1, .L17+24
 197 008c 1C48     		ldr	r0, .L17+16
 198 008e FFF7FEFF 		bl	UsartPrintf
 199              	.LVL12:
 200              		.loc 1 46 79 view .LVU27
  27:./Hardware/onenet/onenet.c **** 	
 201              		.loc 1 27 8 is_stmt 0 view .LVU28
 202 0092 0124     		movs	r4, #1
 203              	.LVL13:
 204              		.loc 1 46 6 view .LVU29
 205 0094 1EE0     		b	.L3
 206              	.LVL14:
 207              	.L9:
  47:./Hardware/onenet/onenet.c **** 					case 2:UsartPrintf(USART_DEBUG, "WARN:	连接失败：非法的clientid\r\n");break;
 208              		.loc 1 47 13 is_stmt 1 view .LVU30
 209 0096 1D49     		ldr	r1, .L17+28
 210 0098 1948     		ldr	r0, .L17+16
 211 009a FFF7FEFF 		bl	UsartPrintf
 212              	.LVL15:
 213              		.loc 1 47 84 view .LVU31
  27:./Hardware/onenet/onenet.c **** 	
 214              		.loc 1 27 8 is_stmt 0 view .LVU32
 215 009e 0124     		movs	r4, #1
 216              	.LVL16:
 217              		.loc 1 47 6 view .LVU33
 218 00a0 18E0     		b	.L3
ARM GAS  /tmp/ccSHUK9b.s 			page 7


 219              	.LVL17:
 220              	.L8:
  48:./Hardware/onenet/onenet.c **** 					case 3:UsartPrintf(USART_DEBUG, "WARN:	连接失败：服务器失败\r\n");break;
 221              		.loc 1 48 13 is_stmt 1 view .LVU34
 222 00a2 1B49     		ldr	r1, .L17+32
 223 00a4 1648     		ldr	r0, .L17+16
 224 00a6 FFF7FEFF 		bl	UsartPrintf
 225              	.LVL18:
 226              		.loc 1 48 82 view .LVU35
  27:./Hardware/onenet/onenet.c **** 	
 227              		.loc 1 27 8 is_stmt 0 view .LVU36
 228 00aa 0124     		movs	r4, #1
 229              	.LVL19:
 230              		.loc 1 48 6 view .LVU37
 231 00ac 12E0     		b	.L3
 232              	.LVL20:
 233              	.L7:
  49:./Hardware/onenet/onenet.c **** 					case 4:UsartPrintf(USART_DEBUG, "WARN:	连接失败：用户名或密码错误\r\n");break;
 234              		.loc 1 49 13 is_stmt 1 view .LVU38
 235 00ae 1949     		ldr	r1, .L17+36
 236 00b0 1348     		ldr	r0, .L17+16
 237 00b2 FFF7FEFF 		bl	UsartPrintf
 238              	.LVL21:
 239              		.loc 1 49 91 view .LVU39
  27:./Hardware/onenet/onenet.c **** 	
 240              		.loc 1 27 8 is_stmt 0 view .LVU40
 241 00b6 0124     		movs	r4, #1
 242              	.LVL22:
 243              		.loc 1 49 6 view .LVU41
 244 00b8 0CE0     		b	.L3
 245              	.LVL23:
 246              	.L5:
  50:./Hardware/onenet/onenet.c **** 					case 5:UsartPrintf(USART_DEBUG, "WARN:	连接失败：非法链接(比如token非法)\r\n");br
 247              		.loc 1 50 13 is_stmt 1 view .LVU42
 248 00ba 1749     		ldr	r1, .L17+40
 249 00bc 1048     		ldr	r0, .L17+16
 250 00be FFF7FEFF 		bl	UsartPrintf
 251              	.LVL24:
 252              		.loc 1 50 98 view .LVU43
  27:./Hardware/onenet/onenet.c **** 	
 253              		.loc 1 27 8 is_stmt 0 view .LVU44
 254 00c2 0124     		movs	r4, #1
 255              	.LVL25:
 256              		.loc 1 50 6 view .LVU45
 257 00c4 06E0     		b	.L3
 258              	.LVL26:
 259              	.L4:
  51:./Hardware/onenet/onenet.c **** 					
  52:./Hardware/onenet/onenet.c **** 					default:UsartPrintf(USART_DEBUG, "ERR:	连接失败：未知错误\r\n");break;
 260              		.loc 1 52 14 is_stmt 1 view .LVU46
 261 00c6 1549     		ldr	r1, .L17+44
 262 00c8 0D48     		ldr	r0, .L17+16
 263 00ca FFF7FEFF 		bl	UsartPrintf
 264              	.LVL27:
 265              		.loc 1 52 79 view .LVU47
  27:./Hardware/onenet/onenet.c **** 	
 266              		.loc 1 27 8 is_stmt 0 view .LVU48
ARM GAS  /tmp/ccSHUK9b.s 			page 8


 267 00ce 0124     		movs	r4, #1
 268              	.LVL28:
 269              		.loc 1 52 6 view .LVU49
 270 00d0 00E0     		b	.L3
 271              	.LVL29:
 272              	.L13:
  27:./Hardware/onenet/onenet.c **** 	
 273              		.loc 1 27 8 view .LVU50
 274 00d2 0124     		movs	r4, #1
 275              	.LVL30:
 276              	.L3:
  53:./Hardware/onenet/onenet.c **** 				}
  54:./Hardware/onenet/onenet.c **** 			}
  55:./Hardware/onenet/onenet.c **** 		}
  56:./Hardware/onenet/onenet.c **** 		
  57:./Hardware/onenet/onenet.c **** 		MQTT_DeleteBuffer(&mqttPacket);								//删包
 277              		.loc 1 57 3 is_stmt 1 view .LVU51
 278 00d4 06A8     		add	r0, sp, #24
 279 00d6 FFF7FEFF 		bl	MQTT_DeleteBuffer
 280              	.LVL31:
 281 00da 04E0     		b	.L12
 282              	.LVL32:
 283              	.L2:
  58:./Hardware/onenet/onenet.c **** 	}
  59:./Hardware/onenet/onenet.c **** 	else
  60:./Hardware/onenet/onenet.c **** 		UsartPrintf(USART_DEBUG, "WARN:	MQTT_PacketConnect Failed\r\n");
 284              		.loc 1 60 3 view .LVU52
 285 00dc 1049     		ldr	r1, .L17+48
 286 00de 0848     		ldr	r0, .L17+16
 287 00e0 FFF7FEFF 		bl	UsartPrintf
 288              	.LVL33:
  27:./Hardware/onenet/onenet.c **** 	
 289              		.loc 1 27 8 is_stmt 0 view .LVU53
 290 00e4 0124     		movs	r4, #1
 291              	.LVL34:
 292              	.L12:
  61:./Hardware/onenet/onenet.c **** 	
  62:./Hardware/onenet/onenet.c **** 	return status;
 293              		.loc 1 62 2 is_stmt 1 view .LVU54
  63:./Hardware/onenet/onenet.c **** 	
  64:./Hardware/onenet/onenet.c **** }
 294              		.loc 1 64 1 is_stmt 0 view .LVU55
 295 00e6 2046     		mov	r0, r4
 296 00e8 0AB0     		add	sp, sp, #40
 297              	.LCFI2:
 298              		.cfi_def_cfa_offset 24
 299              		@ sp needed
 300 00ea BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 301              	.LVL35:
 302              	.L18:
 303              		.loc 1 64 1 view .LVU56
 304 00ee 00BF     		.align	2
 305              	.L17:
 306 00f0 00000000 		.word	.LC0
 307 00f4 08000000 		.word	.LC1
 308 00f8 40000000 		.word	.LC3
 309 00fc 10000000 		.word	.LC2
ARM GAS  /tmp/ccSHUK9b.s 			page 9


 310 0100 00380140 		.word	1073821696
 311 0104 4C000000 		.word	.LC4
 312 0108 64000000 		.word	.LC5
 313 010c 88000000 		.word	.LC6
 314 0110 B4000000 		.word	.LC7
 315 0114 DC000000 		.word	.LC8
 316 0118 0C010000 		.word	.LC9
 317 011c 44010000 		.word	.LC10
 318 0120 68010000 		.word	.LC11
 319              		.cfi_endproc
 320              	.LFE32:
 322              		.section	.rodata.deal_with_onenet_data.str1.4,"aMS",%progbits,1
 323              		.align	2
 324              	.LC12:
 325 0000 4C45445F 		.ascii	"LED_ON\000"
 325      4F4E00
 326 0007 00       		.align	2
 327              	.LC13:
 328 0008 4C45445F 		.ascii	"LED_OFF\000"
 328      4F464600 
 329              		.section	.text.deal_with_onenet_data,"ax",%progbits
 330              		.align	1
 331              		.global	deal_with_onenet_data
 332              		.syntax unified
 333              		.thumb
 334              		.thumb_func
 335              		.fpu softvfp
 337              	deal_with_onenet_data:
 338              	.LFB33:
  65:./Hardware/onenet/onenet.c **** 
  66:./Hardware/onenet/onenet.c **** /**
  67:./Hardware/onenet/onenet.c ****  * @brief  deal_with_onenet_data
  68:./Hardware/onenet/onenet.c ****  * @param  null
  69:./Hardware/onenet/onenet.c ****  * @return null
  70:./Hardware/onenet/onenet.c ****  * @note   此函数是对从 onenet 平台下发的数据做出对应处理的函数
  71:./Hardware/onenet/onenet.c ****  */
  72:./Hardware/onenet/onenet.c **** void deal_with_onenet_data() {
 339              		.loc 1 72 30 is_stmt 1 view -0
 340              		.cfi_startproc
 341              		@ args = 0, pretend = 0, frame = 0
 342              		@ frame_needed = 0, uses_anonymous_args = 0
 343 0000 10B5     		push	{r4, lr}
 344              	.LCFI3:
 345              		.cfi_def_cfa_offset 8
 346              		.cfi_offset 4, -8
 347              		.cfi_offset 14, -4
  73:./Hardware/onenet/onenet.c **** 	if(strstr((char *)req_payload, "LED_ON"))		
 348              		.loc 1 73 2 view .LVU58
 349              		.loc 1 73 5 is_stmt 0 view .LVU59
 350 0002 0A4B     		ldr	r3, .L23
 351 0004 1C68     		ldr	r4, [r3]
 352 0006 0A49     		ldr	r1, .L23+4
 353 0008 2046     		mov	r0, r4
 354 000a FFF7FEFF 		bl	strstr
 355              	.LVL36:
 356              		.loc 1 73 4 view .LVU60
 357 000e 18B1     		cbz	r0, .L20
ARM GAS  /tmp/ccSHUK9b.s 			page 10


  74:./Hardware/onenet/onenet.c **** 	{
  75:./Hardware/onenet/onenet.c **** 		LED1_ON;
 358              		.loc 1 75 3 is_stmt 1 view .LVU61
 359 0010 084B     		ldr	r3, .L23+8
 360 0012 2022     		movs	r2, #32
 361 0014 5A61     		str	r2, [r3, #20]
 362              		.loc 1 75 10 view .LVU62
 363              	.L19:
  76:./Hardware/onenet/onenet.c **** 	}
  77:./Hardware/onenet/onenet.c **** 													
  78:./Hardware/onenet/onenet.c **** 	else if(strstr((char *)req_payload, "LED_OFF"))
  79:./Hardware/onenet/onenet.c **** 	{
  80:./Hardware/onenet/onenet.c **** 		LED1_OFF;
  81:./Hardware/onenet/onenet.c **** 	}
  82:./Hardware/onenet/onenet.c **** }
 364              		.loc 1 82 1 is_stmt 0 view .LVU63
 365 0016 10BD     		pop	{r4, pc}
 366              	.L20:
  78:./Hardware/onenet/onenet.c **** 	{
 367              		.loc 1 78 7 is_stmt 1 view .LVU64
  78:./Hardware/onenet/onenet.c **** 	{
 368              		.loc 1 78 10 is_stmt 0 view .LVU65
 369 0018 0749     		ldr	r1, .L23+12
 370 001a 2046     		mov	r0, r4
 371 001c FFF7FEFF 		bl	strstr
 372              	.LVL37:
  78:./Hardware/onenet/onenet.c **** 	{
 373              		.loc 1 78 9 view .LVU66
 374 0020 0028     		cmp	r0, #0
 375 0022 F8D0     		beq	.L19
  80:./Hardware/onenet/onenet.c **** 	}
 376              		.loc 1 80 3 is_stmt 1 view .LVU67
 377 0024 034B     		ldr	r3, .L23+8
 378 0026 2022     		movs	r2, #32
 379 0028 1A61     		str	r2, [r3, #16]
  80:./Hardware/onenet/onenet.c **** 	}
 380              		.loc 1 80 11 view .LVU68
 381              		.loc 1 82 1 is_stmt 0 view .LVU69
 382 002a F4E7     		b	.L19
 383              	.L24:
 384              		.align	2
 385              	.L23:
 386 002c 00000000 		.word	.LANCHOR0
 387 0030 00000000 		.word	.LC12
 388 0034 000C0140 		.word	1073810432
 389 0038 08000000 		.word	.LC13
 390              		.cfi_endproc
 391              	.LFE33:
 393              		.section	.rodata.OneNet_FillBuf.str1.4,"aMS",%progbits,1
 394              		.align	2
 395              	.LC14:
 396 0000 7B00     		.ascii	"{\000"
 397 0002 0000     		.align	2
 398              	.LC15:
 399 0004 22746573 		.ascii	"\"test\":%d,\000"
 399      74223A25 
 399      642C00
ARM GAS  /tmp/ccSHUK9b.s 			page 11


 400 000f 00       		.align	2
 401              	.LC16:
 402 0010 22746573 		.ascii	"\"test2\":%d\000"
 402      7432223A 
 402      256400
 403 001b 00       		.align	2
 404              	.LC17:
 405 001c 7D00     		.ascii	"}\000"
 406              		.section	.text.OneNet_FillBuf,"ax",%progbits
 407              		.align	1
 408              		.global	OneNet_FillBuf
 409              		.syntax unified
 410              		.thumb
 411              		.thumb_func
 412              		.fpu softvfp
 414              	OneNet_FillBuf:
 415              	.LVL38:
 416              	.LFB34:
  83:./Hardware/onenet/onenet.c **** 
  84:./Hardware/onenet/onenet.c **** unsigned char OneNet_FillBuf(char *buf)
  85:./Hardware/onenet/onenet.c **** {
 417              		.loc 1 85 1 is_stmt 1 view -0
 418              		.cfi_startproc
 419              		@ args = 0, pretend = 0, frame = 48
 420              		@ frame_needed = 0, uses_anonymous_args = 0
 421              		.loc 1 85 1 is_stmt 0 view .LVU71
 422 0000 30B5     		push	{r4, r5, lr}
 423              	.LCFI4:
 424              		.cfi_def_cfa_offset 12
 425              		.cfi_offset 4, -12
 426              		.cfi_offset 5, -8
 427              		.cfi_offset 14, -4
 428 0002 8DB0     		sub	sp, sp, #52
 429              	.LCFI5:
 430              		.cfi_def_cfa_offset 64
 431 0004 0446     		mov	r4, r0
  86:./Hardware/onenet/onenet.c **** 	
  87:./Hardware/onenet/onenet.c **** 	char text[48];
 432              		.loc 1 87 2 is_stmt 1 view .LVU72
  88:./Hardware/onenet/onenet.c **** 	
  89:./Hardware/onenet/onenet.c **** 	memset(text, 0, sizeof(text));
 433              		.loc 1 89 2 view .LVU73
 434 0006 3025     		movs	r5, #48
 435 0008 2A46     		mov	r2, r5
 436 000a 0021     		movs	r1, #0
 437 000c 6846     		mov	r0, sp
 438              	.LVL39:
 439              		.loc 1 89 2 is_stmt 0 view .LVU74
 440 000e FFF7FEFF 		bl	memset
 441              	.LVL40:
  90:./Hardware/onenet/onenet.c **** 	
  91:./Hardware/onenet/onenet.c **** 		strcpy(buf, "{");
 442              		.loc 1 91 3 is_stmt 1 view .LVU75
 443 0012 164B     		ldr	r3, .L27
 444 0014 1B88     		ldrh	r3, [r3]	@ unaligned
 445 0016 2380     		strh	r3, [r4]	@ unaligned
  92:./Hardware/onenet/onenet.c **** 	
ARM GAS  /tmp/ccSHUK9b.s 			page 12


  93:./Hardware/onenet/onenet.c ****     memset(text, 0, sizeof(text));
 446              		.loc 1 93 5 view .LVU76
 447 0018 2A46     		mov	r2, r5
 448 001a 0021     		movs	r1, #0
 449 001c 6846     		mov	r0, sp
 450 001e FFF7FEFF 		bl	memset
 451              	.LVL41:
  94:./Hardware/onenet/onenet.c **** 		sprintf(text, "\"test\":%d,",666); 
 452              		.loc 1 94 3 view .LVU77
 453 0022 40F29A22 		movw	r2, #666
 454 0026 1249     		ldr	r1, .L27+4
 455 0028 6846     		mov	r0, sp
 456 002a FFF7FEFF 		bl	sprintf
 457              	.LVL42:
  95:./Hardware/onenet/onenet.c ****     strcat(buf, text);
 458              		.loc 1 95 5 view .LVU78
 459 002e 6946     		mov	r1, sp
 460 0030 2046     		mov	r0, r4
 461 0032 FFF7FEFF 		bl	strcat
 462              	.LVL43:
  96:./Hardware/onenet/onenet.c **** 		
  97:./Hardware/onenet/onenet.c **** 		memset(text, 0, sizeof(text));
 463              		.loc 1 97 3 view .LVU79
 464 0036 2A46     		mov	r2, r5
 465 0038 0021     		movs	r1, #0
 466 003a 6846     		mov	r0, sp
 467 003c FFF7FEFF 		bl	memset
 468              	.LVL44:
  98:./Hardware/onenet/onenet.c **** 		sprintf(text, "\"test2\":%d",888); 
 469              		.loc 1 98 3 view .LVU80
 470 0040 4FF45E72 		mov	r2, #888
 471 0044 0B49     		ldr	r1, .L27+8
 472 0046 6846     		mov	r0, sp
 473 0048 FFF7FEFF 		bl	sprintf
 474              	.LVL45:
  99:./Hardware/onenet/onenet.c ****     strcat(buf, text);
 475              		.loc 1 99 5 view .LVU81
 476 004c 6946     		mov	r1, sp
 477 004e 2046     		mov	r0, r4
 478 0050 FFF7FEFF 		bl	strcat
 479              	.LVL46:
 100:./Hardware/onenet/onenet.c **** 	
 101:./Hardware/onenet/onenet.c **** 		strcat(buf, "}");
 480              		.loc 1 101 3 view .LVU82
 481 0054 2046     		mov	r0, r4
 482 0056 FFF7FEFF 		bl	strlen
 483              	.LVL47:
 484 005a 074B     		ldr	r3, .L27+12
 485 005c 1B88     		ldrh	r3, [r3]	@ unaligned
 486 005e 2352     		strh	r3, [r4, r0]	@ unaligned
 102:./Hardware/onenet/onenet.c **** 	
 103:./Hardware/onenet/onenet.c **** 	return strlen(buf);
 487              		.loc 1 103 2 view .LVU83
 488              		.loc 1 103 9 is_stmt 0 view .LVU84
 489 0060 2046     		mov	r0, r4
 490 0062 FFF7FEFF 		bl	strlen
 491              	.LVL48:
ARM GAS  /tmp/ccSHUK9b.s 			page 13


 104:./Hardware/onenet/onenet.c **** 
 105:./Hardware/onenet/onenet.c **** }
 492              		.loc 1 105 1 view .LVU85
 493 0066 C0B2     		uxtb	r0, r0
 494 0068 0DB0     		add	sp, sp, #52
 495              	.LCFI6:
 496              		.cfi_def_cfa_offset 12
 497              		@ sp needed
 498 006a 30BD     		pop	{r4, r5, pc}
 499              	.LVL49:
 500              	.L28:
 501              		.loc 1 105 1 view .LVU86
 502              		.align	2
 503              	.L27:
 504 006c 00000000 		.word	.LC14
 505 0070 04000000 		.word	.LC15
 506 0074 10000000 		.word	.LC16
 507 0078 1C000000 		.word	.LC17
 508              		.cfi_endproc
 509              	.LFE34:
 511              		.section	.rodata.OneNet_SendData.str1.4,"aMS",%progbits,1
 512              		.align	2
 513              	.LC18:
 514 0000 54697073 		.ascii	"Tips:\011OneNet_SendData-MQTT\015\012\000"
 514      3A094F6E 
 514      654E6574 
 514      5F53656E 
 514      64446174 
 515 001d 000000   		.align	2
 516              	.LC19:
 517 0020 53656E64 		.ascii	"Send %d Bytes\015\012\000"
 517      20256420 
 517      42797465 
 517      730D0A00 
 518              		.align	2
 519              	.LC20:
 520 0030 5741524E 		.ascii	"WARN:\011EDP_NewBuffer Failed\015\012\000"
 520      3A094544 
 520      505F4E65 
 520      77427566 
 520      66657220 
 521              		.section	.text.OneNet_SendData,"ax",%progbits
 522              		.align	1
 523              		.global	OneNet_SendData
 524              		.syntax unified
 525              		.thumb
 526              		.thumb_func
 527              		.fpu softvfp
 529              	OneNet_SendData:
 530              	.LFB35:
 106:./Hardware/onenet/onenet.c **** 
 107:./Hardware/onenet/onenet.c **** //==========================================================
 108:./Hardware/onenet/onenet.c **** //	函数名称：	OneNet_SendData
 109:./Hardware/onenet/onenet.c **** //
 110:./Hardware/onenet/onenet.c **** //	函数功能：	上传数据到平台
 111:./Hardware/onenet/onenet.c **** //
 112:./Hardware/onenet/onenet.c **** //	入口参数：	type：发送数据的格式
ARM GAS  /tmp/ccSHUK9b.s 			page 14


 113:./Hardware/onenet/onenet.c **** //
 114:./Hardware/onenet/onenet.c **** //	返回参数：	无
 115:./Hardware/onenet/onenet.c **** //
 116:./Hardware/onenet/onenet.c **** //	说明：		
 117:./Hardware/onenet/onenet.c **** //==========================================================
 118:./Hardware/onenet/onenet.c **** void OneNet_SendData(void)
 119:./Hardware/onenet/onenet.c **** {
 531              		.loc 1 119 1 is_stmt 1 view -0
 532              		.cfi_startproc
 533              		@ args = 0, pretend = 0, frame = 144
 534              		@ frame_needed = 0, uses_anonymous_args = 0
 535 0000 10B5     		push	{r4, lr}
 536              	.LCFI7:
 537              		.cfi_def_cfa_offset 8
 538              		.cfi_offset 4, -8
 539              		.cfi_offset 14, -4
 540 0002 A6B0     		sub	sp, sp, #152
 541              	.LCFI8:
 542              		.cfi_def_cfa_offset 160
 120:./Hardware/onenet/onenet.c **** 	
 121:./Hardware/onenet/onenet.c **** 	MQTT_PACKET_STRUCTURE mqttPacket = {NULL, 0, 0, 0};												//协议包
 543              		.loc 1 121 2 view .LVU88
 544              		.loc 1 121 24 is_stmt 0 view .LVU89
 545 0004 0024     		movs	r4, #0
 546 0006 2294     		str	r4, [sp, #136]
 547 0008 2394     		str	r4, [sp, #140]
 548 000a 2494     		str	r4, [sp, #144]
 549 000c 2594     		str	r4, [sp, #148]
 122:./Hardware/onenet/onenet.c **** 	
 123:./Hardware/onenet/onenet.c **** 	char buf[128];
 550              		.loc 1 123 2 is_stmt 1 view .LVU90
 124:./Hardware/onenet/onenet.c **** 	
 125:./Hardware/onenet/onenet.c **** 	short body_len = 0, i = 0;
 551              		.loc 1 125 2 view .LVU91
 552              	.LVL50:
 126:./Hardware/onenet/onenet.c **** 	
 127:./Hardware/onenet/onenet.c **** 	UsartPrintf(USART_DEBUG, "Tips:	OneNet_SendData-MQTT\r\n");
 553              		.loc 1 127 2 view .LVU92
 554 000e 1D49     		ldr	r1, .L36
 555 0010 1D48     		ldr	r0, .L36+4
 556 0012 FFF7FEFF 		bl	UsartPrintf
 557              	.LVL51:
 128:./Hardware/onenet/onenet.c **** 	
 129:./Hardware/onenet/onenet.c **** 	memset(buf, 0, sizeof(buf));
 558              		.loc 1 129 2 view .LVU93
 559 0016 8022     		movs	r2, #128
 560 0018 2146     		mov	r1, r4
 561 001a 02A8     		add	r0, sp, #8
 562 001c FFF7FEFF 		bl	memset
 563              	.LVL52:
 130:./Hardware/onenet/onenet.c **** 	
 131:./Hardware/onenet/onenet.c **** 	body_len = OneNet_FillBuf(buf);																	//获取当前需要发送的数据流的总长度
 564              		.loc 1 131 2 view .LVU94
 565              		.loc 1 131 13 is_stmt 0 view .LVU95
 566 0020 02A8     		add	r0, sp, #8
 567 0022 FFF7FEFF 		bl	OneNet_FillBuf
 568              	.LVL53:
ARM GAS  /tmp/ccSHUK9b.s 			page 15


 569              		.loc 1 131 11 view .LVU96
 570 0026 04B2     		sxth	r4, r0
 571              	.LVL54:
 132:./Hardware/onenet/onenet.c **** 	
 133:./Hardware/onenet/onenet.c **** 	if(body_len)
 572              		.loc 1 133 2 is_stmt 1 view .LVU97
 573              		.loc 1 133 4 is_stmt 0 view .LVU98
 574 0028 0CB9     		cbnz	r4, .L35
 575              	.LVL55:
 576              	.L29:
 134:./Hardware/onenet/onenet.c **** 	{
 135:./Hardware/onenet/onenet.c **** 		if(MQTT_PacketSaveData(DEVID, body_len, NULL, 3, &mqttPacket) == 0)							//封包
 136:./Hardware/onenet/onenet.c **** 		{
 137:./Hardware/onenet/onenet.c **** 			for(; i < body_len; i++)
 138:./Hardware/onenet/onenet.c **** 				mqttPacket._data[mqttPacket._len++] = buf[i];
 139:./Hardware/onenet/onenet.c **** 			
 140:./Hardware/onenet/onenet.c **** 			ESP8266_SendData(mqttPacket._data, mqttPacket._len);									//上传数据到平台
 141:./Hardware/onenet/onenet.c **** 			UsartPrintf(USART_DEBUG, "Send %d Bytes\r\n", mqttPacket._len);
 142:./Hardware/onenet/onenet.c **** 			
 143:./Hardware/onenet/onenet.c **** 			MQTT_DeleteBuffer(&mqttPacket);															//删包
 144:./Hardware/onenet/onenet.c **** 		}
 145:./Hardware/onenet/onenet.c **** 		else
 146:./Hardware/onenet/onenet.c **** 			UsartPrintf(USART_DEBUG, "WARN:	EDP_NewBuffer Failed\r\n");
 147:./Hardware/onenet/onenet.c **** 	}
 148:./Hardware/onenet/onenet.c **** 	
 149:./Hardware/onenet/onenet.c **** }
 577              		.loc 1 149 1 view .LVU99
 578 002a 26B0     		add	sp, sp, #152
 579              	.LCFI9:
 580              		.cfi_remember_state
 581              		.cfi_def_cfa_offset 8
 582              		@ sp needed
 583 002c 10BD     		pop	{r4, pc}
 584              	.LVL56:
 585              	.L35:
 586              	.LCFI10:
 587              		.cfi_restore_state
 135:./Hardware/onenet/onenet.c **** 		{
 588              		.loc 1 135 3 is_stmt 1 view .LVU100
 135:./Hardware/onenet/onenet.c **** 		{
 589              		.loc 1 135 6 is_stmt 0 view .LVU101
 590 002e 22AB     		add	r3, sp, #136
 591 0030 0093     		str	r3, [sp]
 592 0032 0323     		movs	r3, #3
 593 0034 0022     		movs	r2, #0
 594 0036 2146     		mov	r1, r4
 595 0038 1448     		ldr	r0, .L36+8
 596 003a FFF7FEFF 		bl	MQTT_PacketSaveData
 597              	.LVL57:
 135:./Hardware/onenet/onenet.c **** 		{
 598              		.loc 1 135 5 view .LVU102
 599 003e E0B9     		cbnz	r0, .L31
 125:./Hardware/onenet/onenet.c **** 	
 600              		.loc 1 125 22 view .LVU103
 601 0040 0023     		movs	r3, #0
 602 0042 0AE0     		b	.L32
 603              	.LVL58:
ARM GAS  /tmp/ccSHUK9b.s 			page 16


 604              	.L33:
 138:./Hardware/onenet/onenet.c **** 			
 605              		.loc 1 138 5 is_stmt 1 discriminator 2 view .LVU104
 138:./Hardware/onenet/onenet.c **** 			
 606              		.loc 1 138 32 is_stmt 0 discriminator 2 view .LVU105
 607 0044 239A     		ldr	r2, [sp, #140]
 138:./Hardware/onenet/onenet.c **** 			
 608              		.loc 1 138 37 discriminator 2 view .LVU106
 609 0046 511C     		adds	r1, r2, #1
 610 0048 2391     		str	r1, [sp, #140]
 138:./Hardware/onenet/onenet.c **** 			
 611              		.loc 1 138 46 discriminator 2 view .LVU107
 612 004a 26A9     		add	r1, sp, #152
 613 004c 1944     		add	r1, r1, r3
 614 004e 11F8900C 		ldrb	r0, [r1, #-144]	@ zero_extendqisi2
 138:./Hardware/onenet/onenet.c **** 			
 615              		.loc 1 138 41 discriminator 2 view .LVU108
 616 0052 2299     		ldr	r1, [sp, #136]
 617 0054 8854     		strb	r0, [r1, r2]
 137:./Hardware/onenet/onenet.c **** 				mqttPacket._data[mqttPacket._len++] = buf[i];
 618              		.loc 1 137 24 is_stmt 1 discriminator 2 view .LVU109
 137:./Hardware/onenet/onenet.c **** 				mqttPacket._data[mqttPacket._len++] = buf[i];
 619              		.loc 1 137 25 is_stmt 0 discriminator 2 view .LVU110
 620 0056 0133     		adds	r3, r3, #1
 621              	.LVL59:
 137:./Hardware/onenet/onenet.c **** 				mqttPacket._data[mqttPacket._len++] = buf[i];
 622              		.loc 1 137 25 discriminator 2 view .LVU111
 623 0058 1BB2     		sxth	r3, r3
 624              	.LVL60:
 625              	.L32:
 137:./Hardware/onenet/onenet.c **** 				mqttPacket._data[mqttPacket._len++] = buf[i];
 626              		.loc 1 137 10 is_stmt 1 discriminator 1 view .LVU112
 137:./Hardware/onenet/onenet.c **** 				mqttPacket._data[mqttPacket._len++] = buf[i];
 627              		.loc 1 137 4 is_stmt 0 discriminator 1 view .LVU113
 628 005a A342     		cmp	r3, r4
 629 005c F2DB     		blt	.L33
 140:./Hardware/onenet/onenet.c **** 			UsartPrintf(USART_DEBUG, "Send %d Bytes\r\n", mqttPacket._len);
 630              		.loc 1 140 4 is_stmt 1 view .LVU114
 631 005e BDF88C10 		ldrh	r1, [sp, #140]
 632 0062 2298     		ldr	r0, [sp, #136]
 633 0064 FFF7FEFF 		bl	ESP8266_SendData
 634              	.LVL61:
 141:./Hardware/onenet/onenet.c **** 			
 635              		.loc 1 141 4 view .LVU115
 636 0068 239A     		ldr	r2, [sp, #140]
 637 006a 0949     		ldr	r1, .L36+12
 638 006c 0648     		ldr	r0, .L36+4
 639 006e FFF7FEFF 		bl	UsartPrintf
 640              	.LVL62:
 143:./Hardware/onenet/onenet.c **** 		}
 641              		.loc 1 143 4 view .LVU116
 642 0072 22A8     		add	r0, sp, #136
 643 0074 FFF7FEFF 		bl	MQTT_DeleteBuffer
 644              	.LVL63:
 645 0078 D7E7     		b	.L29
 646              	.LVL64:
 647              	.L31:
ARM GAS  /tmp/ccSHUK9b.s 			page 17


 146:./Hardware/onenet/onenet.c **** 	}
 648              		.loc 1 146 4 view .LVU117
 649 007a 0649     		ldr	r1, .L36+16
 650 007c 0248     		ldr	r0, .L36+4
 651 007e FFF7FEFF 		bl	UsartPrintf
 652              	.LVL65:
 653              		.loc 1 149 1 is_stmt 0 view .LVU118
 654 0082 D2E7     		b	.L29
 655              	.L37:
 656              		.align	2
 657              	.L36:
 658 0084 00000000 		.word	.LC18
 659 0088 00380140 		.word	1073821696
 660 008c 40000000 		.word	.LC3
 661 0090 20000000 		.word	.LC19
 662 0094 30000000 		.word	.LC20
 663              		.cfi_endproc
 664              	.LFE35:
 666              		.section	.rodata.OneNet_RevPro.str1.4,"aMS",%progbits,1
 667              		.align	2
 668              	.LC21:
 669 0000 636D6469 		.ascii	"cmdid: %s, req: %s, req_len: %d\015\012\000"
 669      643A2025 
 669      732C2072 
 669      65713A20 
 669      25732C20 
 670 0022 0000     		.align	2
 671              	.LC22:
 672 0024 54697073 		.ascii	"Tips:\011Send CmdResp\015\012\000"
 672      3A095365 
 672      6E642043 
 672      6D645265 
 672      73700D0A 
 673 0039 000000   		.align	2
 674              	.LC23:
 675 003c 54697073 		.ascii	"Tips:\011MQTT Publish Send OK\015\012\000"
 675      3A094D51 
 675      54542050 
 675      75626C69 
 675      73682053 
 676              		.section	.text.OneNet_RevPro,"ax",%progbits
 677              		.align	1
 678              		.global	OneNet_RevPro
 679              		.syntax unified
 680              		.thumb
 681              		.thumb_func
 682              		.fpu softvfp
 684              	OneNet_RevPro:
 685              	.LVL66:
 686              	.LFB36:
 150:./Hardware/onenet/onenet.c **** 
 151:./Hardware/onenet/onenet.c **** //==========================================================
 152:./Hardware/onenet/onenet.c **** //	函数名称：	OneNet_RevPro
 153:./Hardware/onenet/onenet.c **** //
 154:./Hardware/onenet/onenet.c **** //	函数功能：	平台返回数据检测
 155:./Hardware/onenet/onenet.c **** //
 156:./Hardware/onenet/onenet.c **** //	入口参数：	dataPtr：平台返回的数据
ARM GAS  /tmp/ccSHUK9b.s 			page 18


 157:./Hardware/onenet/onenet.c **** //
 158:./Hardware/onenet/onenet.c **** //	返回参数：	无
 159:./Hardware/onenet/onenet.c **** //
 160:./Hardware/onenet/onenet.c **** //	说明：		
 161:./Hardware/onenet/onenet.c **** //==========================================================
 162:./Hardware/onenet/onenet.c **** void OneNet_RevPro(unsigned char *cmd)
 163:./Hardware/onenet/onenet.c **** {
 687              		.loc 1 163 1 is_stmt 1 view -0
 688              		.cfi_startproc
 689              		@ args = 0, pretend = 0, frame = 24
 690              		@ frame_needed = 0, uses_anonymous_args = 0
 691              		.loc 1 163 1 is_stmt 0 view .LVU120
 692 0000 30B5     		push	{r4, r5, lr}
 693              	.LCFI11:
 694              		.cfi_def_cfa_offset 12
 695              		.cfi_offset 4, -12
 696              		.cfi_offset 5, -8
 697              		.cfi_offset 14, -4
 698 0002 89B0     		sub	sp, sp, #36
 699              	.LCFI12:
 700              		.cfi_def_cfa_offset 48
 701 0004 0546     		mov	r5, r0
 164:./Hardware/onenet/onenet.c **** 	
 165:./Hardware/onenet/onenet.c **** 	MQTT_PACKET_STRUCTURE mqttPacket = {NULL, 0, 0, 0};								//协议包
 702              		.loc 1 165 2 is_stmt 1 view .LVU121
 703              		.loc 1 165 24 is_stmt 0 view .LVU122
 704 0006 0023     		movs	r3, #0
 705 0008 0493     		str	r3, [sp, #16]
 706 000a 0593     		str	r3, [sp, #20]
 707 000c 0693     		str	r3, [sp, #24]
 708 000e 0793     		str	r3, [sp, #28]
 166:./Hardware/onenet/onenet.c **** 
 167:./Hardware/onenet/onenet.c **** 	char *cmdid_topic = NULL;
 709              		.loc 1 167 2 is_stmt 1 view .LVU123
 710              		.loc 1 167 8 is_stmt 0 view .LVU124
 711 0010 0393     		str	r3, [sp, #12]
 168:./Hardware/onenet/onenet.c **** 	
 169:./Hardware/onenet/onenet.c **** 	unsigned short req_len = 0;
 712              		.loc 1 169 2 is_stmt 1 view .LVU125
 713              		.loc 1 169 17 is_stmt 0 view .LVU126
 714 0012 ADF80A30 		strh	r3, [sp, #10]	@ movhi
 170:./Hardware/onenet/onenet.c **** 	
 171:./Hardware/onenet/onenet.c **** 	unsigned char type = 0;
 715              		.loc 1 171 2 is_stmt 1 view .LVU127
 716              	.LVL67:
 172:./Hardware/onenet/onenet.c **** 	
 173:./Hardware/onenet/onenet.c **** 	short result = 0;
 717              		.loc 1 173 2 view .LVU128
 174:./Hardware/onenet/onenet.c **** 
 175:./Hardware/onenet/onenet.c **** 	char *dataPtr = NULL;
 718              		.loc 1 175 2 view .LVU129
 176:./Hardware/onenet/onenet.c **** 	char numBuf[10];
 719              		.loc 1 176 2 view .LVU130
 177:./Hardware/onenet/onenet.c **** 	int num = 0;
 720              		.loc 1 177 2 view .LVU131
 178:./Hardware/onenet/onenet.c **** 	
 179:./Hardware/onenet/onenet.c **** 	type = MQTT_UnPacketRecv(cmd);
ARM GAS  /tmp/ccSHUK9b.s 			page 19


 721              		.loc 1 179 2 view .LVU132
 722              		.loc 1 179 9 is_stmt 0 view .LVU133
 723 0016 FFF7FEFF 		bl	MQTT_UnPacketRecv
 724              	.LVL68:
 725              		.loc 1 179 9 view .LVU134
 726 001a 0446     		mov	r4, r0
 727              	.LVL69:
 180:./Hardware/onenet/onenet.c **** 	switch(type)
 728              		.loc 1 180 2 is_stmt 1 view .LVU135
 729 001c 0428     		cmp	r0, #4
 730 001e 31D0     		beq	.L39
 731 0020 0F28     		cmp	r0, #15
 732 0022 07D1     		bne	.L40
 181:./Hardware/onenet/onenet.c **** 	{
 182:./Hardware/onenet/onenet.c **** 		case MQTT_PKT_CMD:															//命令下发
 183:./Hardware/onenet/onenet.c **** 			
 184:./Hardware/onenet/onenet.c **** 			result = MQTT_UnPacketCmd(cmd, &cmdid_topic, &req_payload, &req_len);	//解出topic和消息体
 733              		.loc 1 184 4 view .LVU136
 734              		.loc 1 184 13 is_stmt 0 view .LVU137
 735 0024 0DF10A03 		add	r3, sp, #10
 736 0028 1F4A     		ldr	r2, .L45
 737 002a 03A9     		add	r1, sp, #12
 738 002c 2846     		mov	r0, r5
 739              	.LVL70:
 740              		.loc 1 184 13 view .LVU138
 741 002e FFF7FEFF 		bl	MQTT_UnPacketCmd
 742              	.LVL71:
 185:./Hardware/onenet/onenet.c **** 			if(result == 0)
 743              		.loc 1 185 4 is_stmt 1 view .LVU139
 744              		.loc 1 185 6 is_stmt 0 view .LVU140
 745 0032 48B1     		cbz	r0, .L44
 746              	.LVL72:
 747              	.L40:
 186:./Hardware/onenet/onenet.c **** 			{
 187:./Hardware/onenet/onenet.c **** 				UsartPrintf(USART_DEBUG, "cmdid: %s, req: %s, req_len: %d\r\n", cmdid_topic, req_payload, req_l
 188:./Hardware/onenet/onenet.c **** 				
 189:./Hardware/onenet/onenet.c **** 				if(MQTT_PacketCmdResp(cmdid_topic, req_payload, &mqttPacket) == 0)	//命令回复组包
 190:./Hardware/onenet/onenet.c **** 				{
 191:./Hardware/onenet/onenet.c **** 					UsartPrintf(USART_DEBUG, "Tips:	Send CmdResp\r\n");
 192:./Hardware/onenet/onenet.c **** 					
 193:./Hardware/onenet/onenet.c **** 					ESP8266_SendData(mqttPacket._data, mqttPacket._len);			//回复命令
 194:./Hardware/onenet/onenet.c **** 					MQTT_DeleteBuffer(&mqttPacket);									//删包
 195:./Hardware/onenet/onenet.c **** 				}
 196:./Hardware/onenet/onenet.c **** 			}
 197:./Hardware/onenet/onenet.c **** 		
 198:./Hardware/onenet/onenet.c **** 		break;
 199:./Hardware/onenet/onenet.c **** 			
 200:./Hardware/onenet/onenet.c **** 		case MQTT_PKT_PUBACK:														//发送Publish消息，平台回复的Ack
 201:./Hardware/onenet/onenet.c **** 		
 202:./Hardware/onenet/onenet.c **** 			if(MQTT_UnPacketPublishAck(cmd) == 0)
 203:./Hardware/onenet/onenet.c **** 				UsartPrintf(USART_DEBUG, "Tips:	MQTT Publish Send OK\r\n");
 204:./Hardware/onenet/onenet.c **** 			
 205:./Hardware/onenet/onenet.c **** 		break;
 206:./Hardware/onenet/onenet.c **** 		
 207:./Hardware/onenet/onenet.c **** 		default:
 208:./Hardware/onenet/onenet.c **** 			result = -1;
 209:./Hardware/onenet/onenet.c **** 		break;
ARM GAS  /tmp/ccSHUK9b.s 			page 20


 210:./Hardware/onenet/onenet.c **** 	}
 211:./Hardware/onenet/onenet.c **** 	
 212:./Hardware/onenet/onenet.c **** 	ESP8266_Clear();									//清空缓存
 748              		.loc 1 212 2 is_stmt 1 view .LVU141
 749 0034 FFF7FEFF 		bl	ESP8266_Clear
 750              	.LVL73:
 213:./Hardware/onenet/onenet.c **** 
 214:./Hardware/onenet/onenet.c **** 	//onenet发送的数据做出对应处理
 215:./Hardware/onenet/onenet.c **** 	deal_with_onenet_data();
 751              		.loc 1 215 2 view .LVU142
 752 0038 FFF7FEFF 		bl	deal_with_onenet_data
 753              	.LVL74:
 216:./Hardware/onenet/onenet.c **** 
 217:./Hardware/onenet/onenet.c **** 
 218:./Hardware/onenet/onenet.c **** 	if(type == MQTT_PKT_CMD || type == MQTT_PKT_PUBLISH)
 754              		.loc 1 218 2 view .LVU143
 755              		.loc 1 218 4 is_stmt 0 view .LVU144
 756 003c 0F2C     		cmp	r4, #15
 757 003e 2BD0     		beq	.L41
 758              		.loc 1 218 26 discriminator 1 view .LVU145
 759 0040 032C     		cmp	r4, #3
 760 0042 29D0     		beq	.L41
 761              	.L38:
 219:./Hardware/onenet/onenet.c **** 	{
 220:./Hardware/onenet/onenet.c **** 		MQTT_FreeBuffer(cmdid_topic);
 221:./Hardware/onenet/onenet.c **** 		MQTT_FreeBuffer(req_payload);
 222:./Hardware/onenet/onenet.c **** 	}
 223:./Hardware/onenet/onenet.c **** 
 224:./Hardware/onenet/onenet.c **** }
 762              		.loc 1 224 1 view .LVU146
 763 0044 09B0     		add	sp, sp, #36
 764              	.LCFI13:
 765              		.cfi_remember_state
 766              		.cfi_def_cfa_offset 12
 767              		@ sp needed
 768 0046 30BD     		pop	{r4, r5, pc}
 769              	.LVL75:
 770              	.L44:
 771              	.LCFI14:
 772              		.cfi_restore_state
 773              	.LBB2:
 187:./Hardware/onenet/onenet.c **** 				
 774              		.loc 1 187 5 is_stmt 1 view .LVU147
 775 0048 174D     		ldr	r5, .L45
 776              	.LVL76:
 187:./Hardware/onenet/onenet.c **** 				
 777              		.loc 1 187 5 is_stmt 0 view .LVU148
 778 004a BDF80A30 		ldrh	r3, [sp, #10]
 779 004e 0093     		str	r3, [sp]
 780 0050 2B68     		ldr	r3, [r5]
 781 0052 039A     		ldr	r2, [sp, #12]
 782 0054 1549     		ldr	r1, .L45+4
 783 0056 1648     		ldr	r0, .L45+8
 784              	.LVL77:
 187:./Hardware/onenet/onenet.c **** 				
 785              		.loc 1 187 5 view .LVU149
 786 0058 FFF7FEFF 		bl	UsartPrintf
ARM GAS  /tmp/ccSHUK9b.s 			page 21


 787              	.LVL78:
 189:./Hardware/onenet/onenet.c **** 				{
 788              		.loc 1 189 5 is_stmt 1 view .LVU150
 189:./Hardware/onenet/onenet.c **** 				{
 789              		.loc 1 189 8 is_stmt 0 view .LVU151
 790 005c 04AA     		add	r2, sp, #16
 791 005e 2968     		ldr	r1, [r5]
 792 0060 0398     		ldr	r0, [sp, #12]
 793 0062 FFF7FEFF 		bl	MQTT_PacketCmdResp
 794              	.LVL79:
 189:./Hardware/onenet/onenet.c **** 				{
 795              		.loc 1 189 7 view .LVU152
 796 0066 0028     		cmp	r0, #0
 797 0068 E4D1     		bne	.L40
 191:./Hardware/onenet/onenet.c **** 					
 798              		.loc 1 191 6 is_stmt 1 view .LVU153
 799 006a 1249     		ldr	r1, .L45+12
 800 006c 1048     		ldr	r0, .L45+8
 801 006e FFF7FEFF 		bl	UsartPrintf
 802              	.LVL80:
 193:./Hardware/onenet/onenet.c **** 					MQTT_DeleteBuffer(&mqttPacket);									//删包
 803              		.loc 1 193 6 view .LVU154
 804 0072 BDF81410 		ldrh	r1, [sp, #20]
 805 0076 0498     		ldr	r0, [sp, #16]
 806 0078 FFF7FEFF 		bl	ESP8266_SendData
 807              	.LVL81:
 194:./Hardware/onenet/onenet.c **** 				}
 808              		.loc 1 194 6 view .LVU155
 809 007c 04A8     		add	r0, sp, #16
 810 007e FFF7FEFF 		bl	MQTT_DeleteBuffer
 811              	.LVL82:
 812 0082 D7E7     		b	.L40
 813              	.LVL83:
 814              	.L39:
 194:./Hardware/onenet/onenet.c **** 				}
 815              		.loc 1 194 6 is_stmt 0 view .LVU156
 816              	.LBE2:
 202:./Hardware/onenet/onenet.c **** 				UsartPrintf(USART_DEBUG, "Tips:	MQTT Publish Send OK\r\n");
 817              		.loc 1 202 4 is_stmt 1 view .LVU157
 202:./Hardware/onenet/onenet.c **** 				UsartPrintf(USART_DEBUG, "Tips:	MQTT Publish Send OK\r\n");
 818              		.loc 1 202 7 is_stmt 0 view .LVU158
 819 0084 2846     		mov	r0, r5
 820              	.LVL84:
 202:./Hardware/onenet/onenet.c **** 				UsartPrintf(USART_DEBUG, "Tips:	MQTT Publish Send OK\r\n");
 821              		.loc 1 202 7 view .LVU159
 822 0086 FFF7FEFF 		bl	MQTT_UnPacketPublishAck
 823              	.LVL85:
 202:./Hardware/onenet/onenet.c **** 				UsartPrintf(USART_DEBUG, "Tips:	MQTT Publish Send OK\r\n");
 824              		.loc 1 202 6 view .LVU160
 825 008a 0028     		cmp	r0, #0
 826 008c D2D1     		bne	.L40
 827              	.LBB3:
 203:./Hardware/onenet/onenet.c **** 			
 828              		.loc 1 203 5 is_stmt 1 view .LVU161
 829 008e 0A49     		ldr	r1, .L45+16
 830 0090 0748     		ldr	r0, .L45+8
 831 0092 FFF7FEFF 		bl	UsartPrintf
ARM GAS  /tmp/ccSHUK9b.s 			page 22


 832              	.LVL86:
 833 0096 CDE7     		b	.L40
 834              	.LVL87:
 835              	.L41:
 203:./Hardware/onenet/onenet.c **** 			
 836              		.loc 1 203 5 is_stmt 0 view .LVU162
 837              	.LBE3:
 220:./Hardware/onenet/onenet.c **** 		MQTT_FreeBuffer(req_payload);
 838              		.loc 1 220 3 is_stmt 1 view .LVU163
 839 0098 0398     		ldr	r0, [sp, #12]
 840 009a FFF7FEFF 		bl	free
 841              	.LVL88:
 221:./Hardware/onenet/onenet.c **** 	}
 842              		.loc 1 221 3 view .LVU164
 843 009e 024B     		ldr	r3, .L45
 844 00a0 1868     		ldr	r0, [r3]
 845 00a2 FFF7FEFF 		bl	free
 846              	.LVL89:
 847              		.loc 1 224 1 is_stmt 0 view .LVU165
 848 00a6 CDE7     		b	.L38
 849              	.L46:
 850              		.align	2
 851              	.L45:
 852 00a8 00000000 		.word	.LANCHOR0
 853 00ac 00000000 		.word	.LC21
 854 00b0 00380140 		.word	1073821696
 855 00b4 24000000 		.word	.LC22
 856 00b8 3C000000 		.word	.LC23
 857              		.cfi_endproc
 858              	.LFE36:
 860              		.global	req_payload
 861              		.section	.bss.req_payload,"aw",%nobits
 862              		.align	2
 863              		.set	.LANCHOR0,. + 0
 866              	req_payload:
 867 0000 00000000 		.space	4
 868              		.text
 869              	.Letext0:
 870              		.file 2 "/home/hao/Documents/gcc-arm-none-eabi/arm-none-eabi/include/machine/_default_types.h"
 871              		.file 3 "/home/hao/Documents/gcc-arm-none-eabi/arm-none-eabi/include/sys/_stdint.h"
 872              		.file 4 "./Libraries/CMSIS/stm32f10x.h"
 873              		.file 5 "./Hardware/Common/common.h"
 874              		.file 6 "./Hardware/MQTT/MqttKit.h"
 875              		.file 7 "./Hardware/ESP8266/esp8266.h"
 876              		.file 8 "/home/hao/Documents/gcc-arm-none-eabi/arm-none-eabi/include/stdlib.h"
 877              		.file 9 "/home/hao/Documents/gcc-arm-none-eabi/arm-none-eabi/include/stdio.h"
 878              		.file 10 "/home/hao/Documents/gcc-arm-none-eabi/arm-none-eabi/include/string.h"
 879              		.file 11 "<built-in>"
ARM GAS  /tmp/ccSHUK9b.s 			page 23


DEFINED SYMBOLS
                            *ABS*:0000000000000000 onenet.c
     /tmp/ccSHUK9b.s:16     .rodata.OneNet_DevLink.str1.4:0000000000000000 $d
     /tmp/ccSHUK9b.s:69     .text.OneNet_DevLink:0000000000000000 $t
     /tmp/ccSHUK9b.s:77     .text.OneNet_DevLink:0000000000000000 OneNet_DevLink
     /tmp/ccSHUK9b.s:173    .text.OneNet_DevLink:0000000000000078 $d
     /tmp/ccSHUK9b.s:179    .text.OneNet_DevLink:000000000000007e $t
     /tmp/ccSHUK9b.s:306    .text.OneNet_DevLink:00000000000000f0 $d
     /tmp/ccSHUK9b.s:323    .rodata.deal_with_onenet_data.str1.4:0000000000000000 $d
     /tmp/ccSHUK9b.s:330    .text.deal_with_onenet_data:0000000000000000 $t
     /tmp/ccSHUK9b.s:337    .text.deal_with_onenet_data:0000000000000000 deal_with_onenet_data
     /tmp/ccSHUK9b.s:386    .text.deal_with_onenet_data:000000000000002c $d
     /tmp/ccSHUK9b.s:394    .rodata.OneNet_FillBuf.str1.4:0000000000000000 $d
     /tmp/ccSHUK9b.s:407    .text.OneNet_FillBuf:0000000000000000 $t
     /tmp/ccSHUK9b.s:414    .text.OneNet_FillBuf:0000000000000000 OneNet_FillBuf
     /tmp/ccSHUK9b.s:504    .text.OneNet_FillBuf:000000000000006c $d
     /tmp/ccSHUK9b.s:512    .rodata.OneNet_SendData.str1.4:0000000000000000 $d
     /tmp/ccSHUK9b.s:522    .text.OneNet_SendData:0000000000000000 $t
     /tmp/ccSHUK9b.s:529    .text.OneNet_SendData:0000000000000000 OneNet_SendData
     /tmp/ccSHUK9b.s:658    .text.OneNet_SendData:0000000000000084 $d
     /tmp/ccSHUK9b.s:667    .rodata.OneNet_RevPro.str1.4:0000000000000000 $d
     /tmp/ccSHUK9b.s:677    .text.OneNet_RevPro:0000000000000000 $t
     /tmp/ccSHUK9b.s:684    .text.OneNet_RevPro:0000000000000000 OneNet_RevPro
     /tmp/ccSHUK9b.s:852    .text.OneNet_RevPro:00000000000000a8 $d
     /tmp/ccSHUK9b.s:866    .bss.req_payload:0000000000000000 req_payload
     /tmp/ccSHUK9b.s:862    .bss.req_payload:0000000000000000 $d

UNDEFINED SYMBOLS
UsartPrintf
MQTT_PacketConnect
ESP8266_SendData
ESP8266_GetIPD
MQTT_UnPacketRecv
MQTT_UnPacketConnectAck
MQTT_DeleteBuffer
strstr
memset
sprintf
strcat
strlen
MQTT_PacketSaveData
MQTT_UnPacketCmd
ESP8266_Clear
MQTT_PacketCmdResp
MQTT_UnPacketPublishAck
free
